## 20.16/20.17 shell中的函数

```
函数就是把一段代码整理到了一个小单元中，并给这个小单元起一个名字，当用到这段代码时直接调用这个小单元的名字即可。
格式: function f_name() {
                      command
             }
函数必须要放在最前面
```

**示例1** 

```
#!/bin/bash
input() {
    echo $1 $2 $# $0
}

input 1 a b
```

**示例2** 

```
#!/bin/bash
sum() {
    s=$[$1+$2]
    echo $s
}
sum 1 2
```

**示例3 **

```
#!/bin/bash
ip() {
    ifconfig |grep -A1 "$1 " |tail -1 |awk '{print $2}'|awk -F':' '{print $2}'
}
read -p "Please input the eth name: " e
myip=`ip $e`
echo "$e address is $myip"

```

## 20.18 shell中的数组

```
定义数组 a=(1 2 3 4 5); echo ${a[@]}
echo ${#a[@]} 获取数组的元素个数 
echo ${a[2]} 读取第三个元素，数组从0开始
echo ${a[*]} 等同于 ${a[@]}  显示整个数组
数组赋值
a[1]=100; echo ${a[@]}
a[5]=2; echo ${a[@]} 如果下标不存在则会自动添加一个元素
数组的删除
uset a; unset a[1]
```

数组分片

```
a=(`seq 1 5`)
echo ${a[@]:0:3} 从第一个元素开始，截取3个
echo ${a[@]:1:4} 从第二个元素开始，截取4个
echo ${a[@]:0-3:2} 从倒数第3个元素开始，截取2个
数组替换
echo ${a[@]/3/100}
a=(${a[@]/3/100})
```



## 20.19 告警系统需求分析

* 需求：使用shell定制各种个性化告警工具，但需要统一化管理、规范化管理。
* 思路：指定一个脚本包，包含主程序、子程序、配置文件、邮件引擎、输出日志等。
* 主程序：作为整个脚本的入口，是整个系统的命脉。
* 配置文件：是一个控制中心，用它来开关各个子程序，指定各个相关联的日志文件。
* 子程序：这个才是真正的监控脚本，用来监控各个指标。
* 邮件引擎：是由一个python程序来实现，它可以定义发邮件的服务器、发邮件人以及发件人密码
* 输出日志：整个监控系统要有日志输出。
