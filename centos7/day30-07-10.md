## 10.1 使用w查看系统负载

**这章节内容很重要**

* w/uptime 查看系统负载

**load average: 很重要**
```
第一个数字：单位之间内（1分钟）CPU的活动的进程 这个数字多少好呢？看你的逻辑CPU 数字为1最理想，8核就是不超过8最好，我们关注第一个数字，最能体现系统的负载

第二个数字：5分钟
第三个数字：15分钟

```

**如何查看CPU数量**

```
cat /proc/cpuinfo 
procsssor 0 说明是单核的
一个CPU可以有几核，一个核可以有几个逻辑CPU

```

* uptime和w是一样的
* 阿铭用w只看第一个数字


## 10.2 vmstat命令
比w更近一步了解你的系统
vmstat监控系统状态

vmstat 1 每一秒中动态显示一次
vmstat 1 5 显示5次就结束

关键的几列：r, b, swpd, si, so, bi, bo, us, wa
r: run 表示有多少个进程在状态，注意某一个时间只能有一个进程使用你的CPU，因为你只有一个CPU，其他人要排队，就像轮流排队用电话一样，每个进程都有机会用CPU
b: block 进程给其他东西block了，有多少进程在等待
swpd: 当内存不够就会把数据放到swpd，如何数字不变就还好，如果数字一直变，说明内存不够了
si: 如果swpd被改成 这个会变更 有多少kb的数据从swpd进入到内存中  in
so: 如果swpd被改成 这个会变更 有多少kb的数据从内存出到swpd out
bi: 和磁盘有关系的 从磁盘里出来，进入到内存 读的数据量
bo: 写的数据量 如果这两个数字大，证明你磁盘在频繁的读写

us: 用户级别，显示百分比，用户占用的资源，CPU百分百，大于50就小心了
sy: 系统本身
id: 空闲
上面三个数字相加等于100

wa: wait 等待，等待CPU的百分比，多少进程在等待CPU，如果这个数字大说明CPU不够用

这个命令可以判定系统瓶颈，内存不够呀，磁盘IO太大呀，CPU不够呀


## 10.3 top命令
top 
top -c
top -bn1
q 退出
大写字母P按CPU使用来排序


### CPU行
按数字1 可以查看指定的CPU
us：比较关注
hi
si
st： 被偷走的CPU百分比（如果你的服务器做了虚拟化）

###  内存行

进程是按照CPU百分比来排序
RES是物理内存大小，单位是字节

### 怎么按照内存排序
按大写的M
按P按照CPU排序


主体内容需要关注的部分
RES
%CPU
%MEM
PID

按 top -c 可以查看到具体的命令全局的路径
top -bn1   静态显示，适合在写脚本的时候用

top -bn1静态快照
按数字1显示所有CPU核心的资源使用
top -c 更加详细的command显示

## 10.4 sar命令
被称为Linux系统里面的瑞士军刀
这个命令很强大，重点在于学习网卡流量的监控

yum instal -y sysstat

sar -n DEV 网卡流量
sar -q 系统负载
sar -b 磁盘读写
sar -f /var/log/sa/saxx 历史文件

sar每十分钟把系统的状态过滤一遍，并生产日志在 ls /var/log/sa

sar -m DEV 1 10 跟vmstat一样，查看网卡流量
rxpck/s  接收到的数据包  如果你要接收很多数据包，证明有人给你发送数据包 就是被攻击 几千是正常的，上万就不正常了
txpack/s  发送的数据包

rxkB/s  数据量 
rxcmp/S 数据量

sar -n DEV -f /var/log/sa/sa17  查看网卡流量并指定一个文件
sar -q 1 10 查看系统负载
sar -q -f /var/log/sa/sa17  查看当月16号的数据

## 10.5 nload命令
这个命令可以更好，更直观地显示网卡流量
yum install -y epel-release
yum install -y nload

动态显示网卡实时流量
按方向键 左右 切换网卡， 按q退出
通过情况下我们买带宽指的是出去的带宽
如果你买的带宽是100M  最大值显示70多M 说明你的带宽没跑满，但是也差不多了

有攻击的话 进来的流量很大

sar补充
ls /var/log/sa/  ==> sa17  只能用sar -m查看， 是二进制
ls /var/log/sar/  ==> sar17  这个文件隔天生成，可以直接cat